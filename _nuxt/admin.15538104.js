import{_ as z}from"./ErrorMessage.vue.8c25033d.js";import{f as G,r as k,D as J,v as r,i as S,s as K,o as f,c as h,M as V,N as R,u as o,a as n,b as i,w as p,d as u,F as E,t as m,m as g,n as Q}from"./entry.9bb287b3.js";const W=n("h2",{class:"text-2xl font-bold"},"Datatable Admin",-1),X=n("hr",{class:"my-2 border dark:border-gray-700"},null,-1),Y={class:"col-span-12 flex justify-start gap-1"},Z={key:4,class:"flex gap-2 justify-center"},ee=n("div",{class:"p-2 rounded"},"Sorry, No Data Available",-1),ae=n("hr",{class:"my-2 dark:border-gray-700"},null,-1),te={class:"flex gap-2"},le=n("div",{class:"w-32"},"Selected Data",-1),oe={class:"flex gap-2"},ne=n("div",{class:"w-32"},"Order By",-1),se={class:"flex gap-2"},ie=n("div",{class:"w-32"},"Order Type",-1),re={class:"flex gap-2"},de=n("div",{class:"w-32"},"Search",-1),ue={class:"font-bold"},pe={class:"col-span-12"},me={class:"col-span-12"},ce={class:"col-span-12"},ve={class:"col-span-12"},fe={class:"col-span-12"},he={class:"col-span-12 flex justify-end gap-1"},B="formAdmin",ge=G({__name:"admin",setup(we){const s=k({column:[{label:"Name",field:"name",width:"400px",sortable:!0},{label:"Email",field:"email",width:"400px",sortable:!0},{label:"Phone",field:"phone",width:"400px",sortable:!0},{label:"Role",field:"role",width:"400px",sortable:!0},{label:"Action",field:"action",width:"400px",sortable:!1}],data:[],limit:5,offset:0,search:"",selected:[],sortBy:"name",sortType:"asc",setting:{checkbox:!0,limitOption:[{label:"5",value:5},{label:"10",value:10},{label:"50",value:50},{label:"100",value:100},{label:"200",value:200}]}});var P=k(!1),_=new URLSearchParams;_.append("limit",s.value.limit.toString()),_.append("skip",s.value.offset.toString()),_.append("query",s.value.search.toString());const U=a=>{a()};async function C(){await fetch("/api/admin",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:_,redirect:"follow"}).then(a=>{a!=null&&a.json().then(e=>{e.error==null&&(s.value.data=e.data)})}).catch(a=>{})}async function $(){if(d.value.clearErrors(),await d.value.validate(),d.value.fail()){w.error({message:d.value.getErrorMessage()}),y.value=!0,setTimeout(()=>{y.value=!1},1e3);return}var a=new URLSearchParams;a.append("name",l.inputName),a.append("email",l.inputEmail),a.append("phone",l.inputPhone),a.append("password",l.inputPassword),a.append("role",l.selectRole),$fetch("/api/admin/admin",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a,redirect:"follow"}).then(e=>{e!=null&&T(e)}).catch(e=>{T(e)})}async function I(){if(d.value.clearErrors(),await d.value.validate(),d.value.fail()){w.error({message:d.value.getErrorMessage()}),y.value=!0,setTimeout(()=>{y.value=!1},1e3);return}var a=new URLSearchParams;a.append("id",b.value.id),a.append("name",l.inputName),a.append("email",l.inputEmail),a.append("phone",l.inputPhone),a.append("password",l.inputPassword),a.append("role",l.selectRole),$fetch("/api/admin/admin",{method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a,redirect:"follow"}).then(e=>{e!=null&&T(e)}).catch(e=>{T(e)})}function A(a){var e=new URLSearchParams;return e.append("id",a),$fetch("/api/admin/admin",{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(t=>t!=null?(C(),!0):!1).catch(t=>!1)}J(async()=>C());const F=r.useForm(),q=r.useDialog(),w=r.useToast();async function L(a){if(a!=null){if(!await q.fire({title:`Delete ${a.name}`,description:`Are you sure to delete ${a.name} ?`,icon:"alert-triangle"}))return;A(a.id).then(c=>{c?w.success({message:`Success Delete ${a.name}`}):w.error({message:`Failed Delete ${a.name}`})})}}const y=k(!1),M=S(()=>F.getForm(B)),d=S(()=>M.value.validator);async function T(a){a.error!=null?w.error({message:a.message}):(N(void 0),x(),C(),D())}const l=K({inputName:null,inputEmail:null,inputPhone:null,inputPassword:null,selectRole:null}),O={inputName:["required","string"],inputEmail:["required","string","email"],inputPhone:["required","string"],inputPassword:["required","string"],selectRole:["required"]};function D(){l.selectRole=null,l.inputName=null,l.inputEmail=null,l.inputPhone=null,l.inputPassword=null,d.value.clearErrors()}var b=k();function N(a){b.value=a,a!=null&&(l.inputName=a.name,l.inputEmail=a.email,l.inputPhone=a.phone,l.inputPassword=a.password,l.selectRole=a.role)}const j=[{label:"admin",value:"admin"},{label:"sales",value:"sales"}];function x(){d.value.clearErrors(),P.value=!P.value}return(a,e)=>{const c=z;return f(),h("div",null,[W,X,V(n("div",null,[n("div",Y,[i(o(r.TwButton),{variant:"primary",icon:"user-plus",class:"border border-gray-900 my-2",onClick:e[0]||(e[0]=t=>x())},{default:p(()=>[u(" Add Data ")]),_:1})]),i(o(r.TwDatatableClient),{class:"!dark:text-gray-200",search:s.value.search,"onUpdate:search":e[1]||(e[1]=t=>s.value.search=t),limit:s.value.limit,"onUpdate:limit":e[2]||(e[2]=t=>s.value.limit=t),selected:s.value.selected,"onUpdate:selected":e[3]||(e[3]=t=>s.value.selected=t),"sort-by":s.value.sortBy,"onUpdate:sortBy":e[4]||(e[4]=t=>s.value.sortBy=t),"sort-type":s.value.sortType,"onUpdate:sortType":e[5]||(e[5]=t=>s.value.sortType=t),column:s.value.column,data:s.value.data,setting:s.value.setting,"onDatatable:columnHook":U},{row:p(({column:t,data:v})=>[t.field==="name"?(f(),h(E,{key:0},[u(m(v.name),1)],64)):g("",!0),t.field==="email"?(f(),h(E,{key:1},[u(m(v.email),1)],64)):g("",!0),t.field==="phone"?(f(),h(E,{key:2},[u(m(v.phone),1)],64)):g("",!0),t.field==="role"?(f(),h(E,{key:3},[u(m(v.role),1)],64)):g("",!0),t.field==="action"?(f(),h("div",Z,[i(o(r.TwButton),{variant:"primary",class:"border border-gray-900",onClick:H=>{x(),N(v)}},{default:p(()=>[u(" Edit ")]),_:2},1032,["onClick"]),i(o(r.TwButton),{variant:"danger",onClick:H=>L(v)},{default:p(()=>[u(" Delete ")]),_:2},1032,["onClick"])])):g("",!0)]),empty:p(()=>[ee]),_:1},8,["search","limit","selected","sort-by","sort-type","column","data","setting"]),ae,n("div",null,[n("div",te,[le,n("div",null,": "+m(s.value.selected),1)]),n("div",oe,[ne,n("div",null,": "+m(s.value.sortBy),1)]),n("div",se,[ie,n("div",null,": "+m(s.value.sortType),1)]),n("div",re,[de,n("div",null,": "+m(s.value.search),1)])])],512),[[R,!o(P)]]),V(n("div",null,[n("h1",ue,m(o(b)!=null?`Update Data ${o(b).name}`:"Tambah Data"),1),i(o(r.TwForm),{name:B,class:Q(["grid grid-cols-12 gap-2 bg-white dark:bg-gray-900 dark:border dark:border-gray-700 rounded-lg p-2 shadow",{"tw-shake":y.value}]),rules:O,onSubmit:e[13]||(e[13]=t=>o(b)!=null?I():$()),"custom-field-name":{inputName:"Input",inputEmail:"Input",inputPhone:"Input",inputPassword:"Input"}},{default:p(()=>[n("div",pe,[i(o(r.TwInput),{label:"Name",name:"inputName",modelValue:o(l).inputName,"onUpdate:modelValue":e[6]||(e[6]=t=>o(l).inputName=t),placeholder:"Input Name",type:"text"},null,8,["modelValue"]),i(c,{name:"inputName"})]),n("div",me,[i(o(r.TwInput),{label:"Email",name:"inputEmail",modelValue:o(l).inputEmail,"onUpdate:modelValue":e[7]||(e[7]=t=>o(l).inputEmail=t),placeholder:"Input Email",type:"text"},null,8,["modelValue"]),i(c,{name:"inputEmail"})]),n("div",ce,[i(o(r.TwInput),{label:"Phone",name:"inputPhone",modelValue:o(l).inputPhone,"onUpdate:modelValue":e[8]||(e[8]=t=>o(l).inputPhone=t),placeholder:"Input Phone",type:"text"},null,8,["modelValue"]),i(c,{name:"inputPhone"})]),n("div",ve,[i(o(r.TwInput),{label:"Password",name:"inputPassword",modelValue:o(l).inputPassword,"onUpdate:modelValue":e[9]||(e[9]=t=>o(l).inputPassword=t),placeholder:"Input Password",type:"text"},null,8,["modelValue"]),i(c,{name:"inputPassword"})]),n("div",fe,[i(o(r.TwSelect),{label:"Role",name:"selectRole",modelValue:o(l).selectRole,"onUpdate:modelValue":e[10]||(e[10]=t=>o(l).selectRole=t),items:j,placeholder:"Choose select"},null,8,["modelValue"]),i(c,{name:"selectRole"})]),n("div",he,[i(o(r.TwButton),{variant:"primary",type:"button",class:"border border-gray-900",onClick:e[11]||(e[11]=t=>{D(),x(),N(void 0)})},{default:p(()=>[u(" Close ")]),_:1}),i(o(r.TwButton),{ripple:"",variant:"secondary",type:"button",class:"dark:text-gray-200 dark:!border-gray-800 dark:border",onClick:e[12]||(e[12]=t=>D())},{default:p(()=>[u(" Reset ")]),_:1}),i(o(r.TwButton),{variant:"primary"},{default:p(()=>[u(" Submit ")]),_:1})])]),_:1},8,["class"])],512),[[R,o(P)]])])}}});export{ge as default};
