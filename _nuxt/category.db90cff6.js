import{_ as H}from"./ErrorMessage.vue.830f5050.js";import{f as I,r as _,D as z,v as s,i as S,s as G,o as D,c as N,M as B,N as $,u as l,a as t,b as i,w as d,d as u,F as J,t as m,m as E,n as K}from"./entry.840b05cf.js";const Q=t("h2",{class:"text-2xl font-bold"},"Datatable Category",-1),W=t("hr",{class:"my-2 border dark:border-gray-700"},null,-1),X={class:"col-span-12 flex justify-start gap-1"},Y={key:1,class:"flex gap-2 justify-center"},Z=t("div",{class:"p-2 rounded"},"Sorry, No Data Available",-1),ee=t("hr",{class:"my-2 dark:border-gray-700"},null,-1),ae={class:"flex gap-2"},te=t("div",{class:"w-32"},"Selected Data",-1),oe={class:"flex gap-2"},re=t("div",{class:"w-32"},"Order By",-1),le={class:"flex gap-2"},se=t("div",{class:"w-32"},"Order Type",-1),ne={class:"flex gap-2"},ie=t("div",{class:"w-32"},"Search",-1),de={class:"font-bold"},ue={class:"col-span-12"},ce={class:"col-span-12 flex justify-end gap-1"},U="formCategory",fe=I({__name:"category",setup(me){const o=_({column:[{label:"Name",field:"name",width:"400px",sortable:!0},{label:"Action",field:"action",width:"400px",sortable:!1}],data:[],limit:5,offset:0,search:"",selected:[],sortBy:"name",sortType:"asc",setting:{checkbox:!0,limitOption:[{label:"5",value:5},{label:"10",value:10},{label:"50",value:50},{label:"100",value:100},{label:"200",value:200}]}});var y=_(!1),g=new URLSearchParams;g.append("limit",o.value.limit.toString()),g.append("skip",o.value.offset.toString()),g.append("query",o.value.search.toString());const P=a=>{a()};async function T(){await fetch("/api/category",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:g,redirect:"follow"}).then(a=>{a!=null&&a.json().then(e=>{e.error==null&&(o.value.data=e.data)})}).catch(a=>{})}async function F(){if(n.value.clearErrors(),await n.value.validate(),n.value.fail()){v.error({message:n.value.getErrorMessage()}),p.value=!0,setTimeout(()=>{p.value=!1},1e3);return}var a=new URLSearchParams;a.append("name",c.inputName),$fetch("/api/category/category",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a,redirect:"follow"}).then(e=>{e!=null&&b(e)}).catch(e=>{b(e)})}async function V(){if(n.value.clearErrors(),await n.value.validate(),n.value.fail()){v.error({message:n.value.getErrorMessage()}),p.value=!0,setTimeout(()=>{p.value=!1},1e3);return}var a=new URLSearchParams;a.append("id",f.value.id),a.append("name",c.inputName),$fetch("/api/category/category",{method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a,redirect:"follow"}).then(e=>{e!=null&&b(e)}).catch(e=>{b(e)})}function R(a){var e=new URLSearchParams;return e.append("id",a),$fetch("/api/category/category",{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(r=>r!=null?(T(),!0):!1).catch(r=>!1)}z(async()=>T());const A=s.useForm(),L=s.useDialog(),v=s.useToast();async function M(a){if(a!=null){if(!await L.fire({title:`Delete ${a.name}`,description:`Are you sure to delete ${a.name} ?`,icon:"alert-triangle"}))return;R(a.id).then(w=>{w?v.success({message:`Success Delete ${a.name}`}):v.error({message:`Failed Delete ${a.name}`})})}}const p=_(!1),O=S(()=>A.getForm(U)),n=S(()=>O.value.validator);async function b(a){a.error!=null?v.error({message:a.message}):(k(void 0),h(),T(),C())}const c=G({inputName:null}),j={inputName:["required","string"]};function C(){c.inputName=null,n.value.clearErrors()}var f=_();function k(a){f.value=a,a!=null&&(c.inputName=a.name)}function h(){n.value.clearErrors(),y.value=!y.value}return(a,e)=>{const w=H;return D(),N("div",null,[Q,W,B(t("div",null,[t("div",X,[i(l(s.TwButton),{variant:"primary",icon:"plus-square",class:"border border-gray-900 my-2",onClick:e[0]||(e[0]=r=>h())},{default:d(()=>[u(" Add Data ")]),_:1})]),i(l(s.TwDatatableClient),{class:"!dark:text-gray-200",search:o.value.search,"onUpdate:search":e[1]||(e[1]=r=>o.value.search=r),limit:o.value.limit,"onUpdate:limit":e[2]||(e[2]=r=>o.value.limit=r),selected:o.value.selected,"onUpdate:selected":e[3]||(e[3]=r=>o.value.selected=r),"sort-by":o.value.sortBy,"onUpdate:sortBy":e[4]||(e[4]=r=>o.value.sortBy=r),"sort-type":o.value.sortType,"onUpdate:sortType":e[5]||(e[5]=r=>o.value.sortType=r),column:o.value.column,data:o.value.data,setting:o.value.setting,"onDatatable:columnHook":P},{row:d(({column:r,data:x})=>[r.field==="name"?(D(),N(J,{key:0},[u(m(x.name),1)],64)):E("",!0),r.field==="action"?(D(),N("div",Y,[i(l(s.TwButton),{variant:"primary",class:"border border-gray-900",onClick:q=>{h(),k(x)}},{default:d(()=>[u(" Edit ")]),_:2},1032,["onClick"]),i(l(s.TwButton),{variant:"danger",onClick:q=>M(x)},{default:d(()=>[u(" Delete ")]),_:2},1032,["onClick"])])):E("",!0)]),empty:d(()=>[Z]),_:1},8,["search","limit","selected","sort-by","sort-type","column","data","setting"]),ee,t("div",null,[t("div",ae,[te,t("div",null,": "+m(o.value.selected),1)]),t("div",oe,[re,t("div",null,": "+m(o.value.sortBy),1)]),t("div",le,[se,t("div",null,": "+m(o.value.sortType),1)]),t("div",ne,[ie,t("div",null,": "+m(o.value.search),1)])])],512),[[$,!l(y)]]),B(t("div",null,[t("h1",de,m(l(f)!=null?`Update Data ${l(f).name}`:"Tambah Data"),1),i(l(s.TwForm),{name:U,class:K(["grid grid-cols-12 gap-2 bg-white dark:bg-gray-900 dark:border dark:border-gray-700 rounded-lg p-2 shadow",{"tw-shake":p.value}]),rules:j,onSubmit:e[9]||(e[9]=r=>l(f)!=null?V():F()),"custom-field-name":{inputName:"Input"}},{default:d(()=>[t("div",ue,[i(l(s.TwInput),{label:"Name",name:"inputName",modelValue:l(c).inputName,"onUpdate:modelValue":e[6]||(e[6]=r=>l(c).inputName=r),placeholder:"Input Name",type:"text"},null,8,["modelValue"]),i(w,{name:"inputName"})]),t("div",ce,[i(l(s.TwButton),{variant:"primary",type:"button",class:"border border-gray-900",onClick:e[7]||(e[7]=r=>{C(),h(),k(void 0)})},{default:d(()=>[u(" Close ")]),_:1}),i(l(s.TwButton),{ripple:"",variant:"secondary",type:"button",class:"dark:text-gray-200 dark:!border-gray-800 dark:border",onClick:e[8]||(e[8]=r=>C())},{default:d(()=>[u(" Reset ")]),_:1}),i(l(s.TwButton),{variant:"primary"},{default:d(()=>[u(" Submit ")]),_:1})])]),_:1},8,["class"])],512),[[$,l(y)]])])}}});export{fe as default};
