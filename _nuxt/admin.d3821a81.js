import{_ as G}from"./ErrorMessage.vue.830f5050.js";import{f as J,r as k,D as K,v as r,i as R,s as Q,o as f,c as h,M as S,N as V,u as o,a as n,b as i,w as m,d as p,F as E,t as c,m as g,n as W}from"./entry.840b05cf.js";const X=n("h2",{class:"text-2xl font-bold"},"Datatable Admin",-1),Y=n("hr",{class:"my-2 border dark:border-gray-700"},null,-1),Z={class:"col-span-12 flex justify-start gap-1"},ee={key:4,class:"flex gap-2 justify-center"},ae=n("div",{class:"p-2 rounded"},"Sorry, No Data Available",-1),te=n("hr",{class:"my-2 dark:border-gray-700"},null,-1),le={class:"flex gap-2"},oe=n("div",{class:"w-32"},"Selected Data",-1),ne={class:"flex gap-2"},se=n("div",{class:"w-32"},"Order By",-1),ie={class:"flex gap-2"},re=n("div",{class:"w-32"},"Order Type",-1),de={class:"flex gap-2"},ue=n("div",{class:"w-32"},"Search",-1),pe={class:"font-bold"},me={class:"col-span-12"},ce={class:"col-span-12"},ve={class:"col-span-12"},fe={class:"col-span-12"},he={class:"col-span-12"},we={class:"col-span-12 flex justify-end gap-1"},B="formAdmin",Pe=J({__name:"admin",setup(ye){const s=k({column:[{label:"Name",field:"name",width:"400px",sortable:!0},{label:"Email",field:"email",width:"400px",sortable:!0},{label:"Phone",field:"phone",width:"400px",sortable:!0},{label:"Role",field:"role",width:"400px",sortable:!0},{label:"Action",field:"action",width:"400px",sortable:!1}],data:[],limit:5,offset:0,search:"",selected:[],sortBy:"name",sortType:"asc",setting:{checkbox:!0,limitOption:[{label:"5",value:5},{label:"10",value:10},{label:"50",value:50},{label:"100",value:100},{label:"200",value:200}]}});var P=k(!1),_=new URLSearchParams;_.append("limit",s.value.limit.toString()),_.append("skip",s.value.offset.toString()),_.append("query",s.value.search.toString());const U=a=>{a()};function $(a,e,d){a[d]=a[e],delete a[e]}async function C(){await fetch("/api/admin",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:_,redirect:"follow"}).then(a=>{a!=null&&a.json().then(e=>{if(e.error==null){const d=e;d.forEach(t=>$(t,"_id","id")),s.value.data=d}})}).catch(a=>{})}async function I(){if(u.value.clearErrors(),await u.value.validate(),u.value.fail()){w.error({message:u.value.getErrorMessage()}),y.value=!0,setTimeout(()=>{y.value=!1},1e3);return}var a=new URLSearchParams;a.append("name",l.inputName),a.append("email",l.inputEmail),a.append("phone",l.inputPhone),a.append("password",l.inputPassword),a.append("role",l.selectRole),$fetch("/api/admin/admin",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a,redirect:"follow"}).then(e=>{e!=null&&T(e)}).catch(e=>{T(e)})}async function A(){if(u.value.clearErrors(),await u.value.validate(),u.value.fail()){w.error({message:u.value.getErrorMessage()}),y.value=!0,setTimeout(()=>{y.value=!1},1e3);return}var a=new URLSearchParams;a.append("id",b.value.id),a.append("name",l.inputName),a.append("email",l.inputEmail),a.append("phone",l.inputPhone),a.append("password",l.inputPassword),a.append("role",l.selectRole),$fetch("/api/admin/admin",{method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a,redirect:"follow"}).then(e=>{e!=null&&T(e)}).catch(e=>{T(e)})}function F(a){var e=new URLSearchParams;return e.append("id",a),$fetch("/api/admin/admin",{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(t=>t!=null?(C(),!0):!1).catch(t=>!1)}K(async()=>C());const q=r.useForm(),L=r.useDialog(),w=r.useToast();async function M(a){if(a!=null){if(!await L.fire({title:`Delete ${a.name}`,description:`Are you sure to delete ${a.name} ?`,icon:"alert-triangle"}))return;F(a.id).then(d=>{d?w.success({message:`Success Delete ${a.name}`}):w.error({message:`Failed Delete ${a.name}`})})}}const y=k(!1),O=R(()=>q.getForm(B)),u=R(()=>O.value.validator);async function T(a){a.error!=null?w.error({message:a.message}):(N(void 0),x(),C(),D())}const l=Q({inputName:null,inputEmail:null,inputPhone:null,inputPassword:null,selectRole:null}),H={inputName:["required","string"],inputEmail:["required","string","email"],inputPhone:["required","string"],inputPassword:["required","string"],selectRole:["required"]};function D(){l.selectRole=null,l.inputName=null,l.inputEmail=null,l.inputPhone=null,l.inputPassword=null,u.value.clearErrors()}var b=k();function N(a){b.value=a,a!=null&&(l.inputName=a.name,l.inputEmail=a.email,l.inputPhone=a.phone,l.inputPassword=a.password,l.selectRole=a.role)}const j=[{label:"admin",value:"admin"},{label:"sales",value:"sales"}];function x(){u.value.clearErrors(),P.value=!P.value}return(a,e)=>{const d=G;return f(),h("div",null,[X,Y,S(n("div",null,[n("div",Z,[i(o(r.TwButton),{variant:"primary",icon:"user-plus",class:"border border-gray-900 my-2",onClick:e[0]||(e[0]=t=>x())},{default:m(()=>[p(" Add Data ")]),_:1})]),i(o(r.TwDatatableClient),{class:"!dark:text-gray-200",search:s.value.search,"onUpdate:search":e[1]||(e[1]=t=>s.value.search=t),limit:s.value.limit,"onUpdate:limit":e[2]||(e[2]=t=>s.value.limit=t),selected:s.value.selected,"onUpdate:selected":e[3]||(e[3]=t=>s.value.selected=t),"sort-by":s.value.sortBy,"onUpdate:sortBy":e[4]||(e[4]=t=>s.value.sortBy=t),"sort-type":s.value.sortType,"onUpdate:sortType":e[5]||(e[5]=t=>s.value.sortType=t),column:s.value.column,data:s.value.data,setting:s.value.setting,"onDatatable:columnHook":U},{row:m(({column:t,data:v})=>[t.field==="name"?(f(),h(E,{key:0},[p(c(v.name),1)],64)):g("",!0),t.field==="email"?(f(),h(E,{key:1},[p(c(v.email),1)],64)):g("",!0),t.field==="phone"?(f(),h(E,{key:2},[p(c(v.phone),1)],64)):g("",!0),t.field==="role"?(f(),h(E,{key:3},[p(c(v.role),1)],64)):g("",!0),t.field==="action"?(f(),h("div",ee,[i(o(r.TwButton),{variant:"primary",class:"border border-gray-900",onClick:z=>{x(),N(v)}},{default:m(()=>[p(" Edit ")]),_:2},1032,["onClick"]),i(o(r.TwButton),{variant:"danger",onClick:z=>M(v)},{default:m(()=>[p(" Delete ")]),_:2},1032,["onClick"])])):g("",!0)]),empty:m(()=>[ae]),_:1},8,["search","limit","selected","sort-by","sort-type","column","data","setting"]),te,n("div",null,[n("div",le,[oe,n("div",null,": "+c(s.value.selected),1)]),n("div",ne,[se,n("div",null,": "+c(s.value.sortBy),1)]),n("div",ie,[re,n("div",null,": "+c(s.value.sortType),1)]),n("div",de,[ue,n("div",null,": "+c(s.value.search),1)])])],512),[[V,!o(P)]]),S(n("div",null,[n("h1",pe,c(o(b)!=null?`Update Data ${o(b).name}`:"Tambah Data"),1),i(o(r.TwForm),{name:B,class:W(["grid grid-cols-12 gap-2 bg-white dark:bg-gray-900 dark:border dark:border-gray-700 rounded-lg p-2 shadow",{"tw-shake":y.value}]),rules:H,onSubmit:e[13]||(e[13]=t=>o(b)!=null?A():I()),"custom-field-name":{inputName:"Input",inputEmail:"Input",inputPhone:"Input",inputPassword:"Input"}},{default:m(()=>[n("div",me,[i(o(r.TwInput),{label:"Name",name:"inputName",modelValue:o(l).inputName,"onUpdate:modelValue":e[6]||(e[6]=t=>o(l).inputName=t),placeholder:"Input Name",type:"text"},null,8,["modelValue"]),i(d,{name:"inputName"})]),n("div",ce,[i(o(r.TwInput),{label:"Email",name:"inputEmail",modelValue:o(l).inputEmail,"onUpdate:modelValue":e[7]||(e[7]=t=>o(l).inputEmail=t),placeholder:"Input Email",type:"text"},null,8,["modelValue"]),i(d,{name:"inputEmail"})]),n("div",ve,[i(o(r.TwInput),{label:"Phone",name:"inputPhone",modelValue:o(l).inputPhone,"onUpdate:modelValue":e[8]||(e[8]=t=>o(l).inputPhone=t),placeholder:"Input Phone",type:"text"},null,8,["modelValue"]),i(d,{name:"inputPhone"})]),n("div",fe,[i(o(r.TwInput),{label:"Password",name:"inputPassword",modelValue:o(l).inputPassword,"onUpdate:modelValue":e[9]||(e[9]=t=>o(l).inputPassword=t),placeholder:"Input Password",type:"text"},null,8,["modelValue"]),i(d,{name:"inputPassword"})]),n("div",he,[i(o(r.TwSelect),{label:"Role",name:"selectRole",modelValue:o(l).selectRole,"onUpdate:modelValue":e[10]||(e[10]=t=>o(l).selectRole=t),items:j,placeholder:"Choose select"},null,8,["modelValue"]),i(d,{name:"selectRole"})]),n("div",we,[i(o(r.TwButton),{variant:"primary",type:"button",class:"border border-gray-900",onClick:e[11]||(e[11]=t=>{D(),x(),N(void 0)})},{default:m(()=>[p(" Close ")]),_:1}),i(o(r.TwButton),{ripple:"",variant:"secondary",type:"button",class:"dark:text-gray-200 dark:!border-gray-800 dark:border",onClick:e[12]||(e[12]=t=>D())},{default:m(()=>[p(" Reset ")]),_:1}),i(o(r.TwButton),{variant:"primary"},{default:m(()=>[p(" Submit ")]),_:1})])]),_:1},8,["class"])],512),[[V,o(P)]])])}}});export{Pe as default};
