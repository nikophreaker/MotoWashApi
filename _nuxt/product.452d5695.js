import{_ as J}from"./ErrorMessage.vue.1a46e9a0.js";import{f as K,r as S,D as W,v as s,i as $,s as X,o as y,c as g,M as V,N as B,u as o,a as r,b as l,w as v,d as p,F as P,t as f,m as k,n as Y}from"./entry.b4992638.js";const Z=r("h2",{class:"text-2xl font-bold"},"Datatable Product",-1),ee=r("hr",{class:"my-2 border dark:border-gray-700"},null,-1),te={class:"col-span-12 flex justify-start gap-1"},ae={key:4,class:"flex gap-2 justify-center"},re=r("div",{class:"p-2 rounded"},"Sorry, No Data Available",-1),oe=r("hr",{class:"my-2 dark:border-gray-700"},null,-1),ie={class:"flex gap-2"},ne=r("div",{class:"w-32"},"Selected Data",-1),le={class:"flex gap-2"},se=r("div",{class:"w-32"},"Order By",-1),de={class:"flex gap-2"},ue=r("div",{class:"w-32"},"Order Type",-1),ce={class:"flex gap-2"},pe=r("div",{class:"w-32"},"Search",-1),me={class:"font-bold"},ve={class:"col-span-12"},fe={class:"col-span-12"},ye={class:"col-span-12"},ge={class:"col-span-12"},be={class:"col-span-12 flex justify-end gap-1"},U="formProduct",xe=K({__name:"product",setup(he){const n=S({column:[{label:"Name",field:"name",width:"400px",sortable:!0},{label:"Description",field:"description",width:"400px",sortable:!0},{label:"Stock",field:"stock",width:"400px",sortable:!0},{label:"Price",field:"price",width:"400px",sortable:!0},{label:"Action",field:"action",width:"400px",sortable:!1}],data:[],limit:5,offset:0,search:"",selected:[],sortBy:"name",sortType:"asc",setting:{checkbox:!0,limitOption:[{label:"5",value:5},{label:"10",value:10},{label:"50",value:50},{label:"100",value:100},{label:"200",value:200}]}});var x=S(!1),_=new URLSearchParams;_.append("limit",n.value.limit.toString()),_.append("skip",n.value.offset.toString()),_.append("query",n.value.search.toString());const I=t=>{t()};function R(t,e,d){t[d]=t[e],delete t[e]}async function N(){await fetch("/api/product",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:_,redirect:"follow"}).then(t=>{t!=null&&t.json().then(e=>{if(e.error==null){const d=e;d.forEach(a=>R(a,"_id","id")),n.value.data=d}})}).catch(t=>{})}async function M(){if(u.value.clearErrors(),await u.value.validate(),u.value.fail()){b.error({message:u.value.getErrorMessage()}),h.value=!0,setTimeout(()=>{h.value=!1},1e3);return}var t=new URLSearchParams;t.append("name",i.inputName),t.append("description",i.textAreaDescription),t.append("stockQuantity",i.inputStock),t.append("price",i.inputPrice),$fetch("/api/product/product",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,redirect:"follow"}).then(e=>{e!=null&&T(e)}).catch(e=>{T(e)})}async function F(){if(u.value.clearErrors(),await u.value.validate(),u.value.fail()){b.error({message:u.value.getErrorMessage()}),h.value=!0,setTimeout(()=>{h.value=!1},1e3);return}var t=new URLSearchParams;t.append("id",w.value.id),t.append("name",i.inputName),t.append("description",i.textAreaDescription),t.append("stockQuantity",i.inputStock),t.append("price",i.inputPrice),$fetch("/api/product/product",{method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,redirect:"follow"}).then(e=>{e!=null&&T(e)}).catch(e=>{T(e)})}function L(t){var e=new URLSearchParams;return e.append("id",t),$fetch("/api/product/product",{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(a=>a!=null?(N(),!0):!1).catch(a=>!1)}W(async()=>N());const q=s.useForm(),H=s.useDialog(),b=s.useToast();async function O(t){if(t!=null){if(!await H.fire({title:`Delete ${t.name}`,description:`Are you sure to delete ${t.name} ?`,icon:"alert-triangle"}))return;L(t.id).then(d=>{d?b.success({message:`Success Delete ${t.name}`}):b.error({message:`Failed Delete ${t.name}`})})}}const h=S(!1),G=$(()=>q.getForm(U)),u=$(()=>G.value.validator);async function T(t){t.error!=null?b.error({message:t.message}):(E(void 0),D(),N(),C())}const i=X({inputName:null,inputStock:null,inputPrice:null,textAreaDescription:null}),Q={inputName:["required","string"],inputStock:["required","numeric"],inputPrice:["required","string"],textAreaDescription:["required","string",t=>{if(!t||t.length<15)return`Min length is 15, current length is ${t.length}`}]};function C(){i.inputName=null,i.inputStock=null,i.inputPrice=null,i.textAreaDescription=null,u.value.clearErrors()}var w=S();function E(t){w.value=t,t!=null&&(i.inputName=t.name,i.textAreaDescription=t.description,i.inputStock=t.stockQuantity,i.inputPrice=t.price)}function D(){u.value.clearErrors(),x.value=!x.value}function j(t,e){var d=t.replace(/[^,\d]/g,"").toString(),a=d.split(","),c=a[0].length%3,m=a[0].substr(0,c),A=a[0].substr(c).match(/\d{3}/gi);if(A){var z=c?".":"";m+=z+A.join(".")}return m=a[1]!=null?m+","+a[1]:m,e==null?m:m?"Rp. "+m:""}return(t,e)=>{const d=J;return y(),g("div",null,[Z,ee,V(r("div",null,[r("div",te,[l(o(s.TwButton),{variant:"primary",icon:"plus-square",class:"border border-gray-900 my-2",onClick:e[0]||(e[0]=a=>D())},{default:v(()=>[p(" Add Data ")]),_:1})]),l(o(s.TwDatatableClient),{class:"!dark:text-gray-200",search:n.value.search,"onUpdate:search":e[1]||(e[1]=a=>n.value.search=a),limit:n.value.limit,"onUpdate:limit":e[2]||(e[2]=a=>n.value.limit=a),selected:n.value.selected,"onUpdate:selected":e[3]||(e[3]=a=>n.value.selected=a),"sort-by":n.value.sortBy,"onUpdate:sortBy":e[4]||(e[4]=a=>n.value.sortBy=a),"sort-type":n.value.sortType,"onUpdate:sortType":e[5]||(e[5]=a=>n.value.sortType=a),column:n.value.column,data:n.value.data,setting:n.value.setting,"onDatatable:columnHook":I},{row:v(({column:a,data:c})=>[a.field==="name"?(y(),g(P,{key:0},[p(f(c.name),1)],64)):k("",!0),a.field==="description"?(y(),g(P,{key:1},[p(f(c.description),1)],64)):k("",!0),a.field==="stock"?(y(),g(P,{key:2},[p(f(Number(c.stockQuantity)),1)],64)):k("",!0),a.field==="price"?(y(),g(P,{key:3},[p(f(j(c.price.toString(),"Rp. ")),1)],64)):k("",!0),a.field==="action"?(y(),g("div",ae,[l(o(s.TwButton),{variant:"primary",class:"border border-gray-900",onClick:m=>{D(),E(c)}},{default:v(()=>[p(" Edit ")]),_:2},1032,["onClick"]),l(o(s.TwButton),{variant:"danger",onClick:m=>O(c)},{default:v(()=>[p(" Delete ")]),_:2},1032,["onClick"])])):k("",!0)]),empty:v(()=>[re]),_:1},8,["search","limit","selected","sort-by","sort-type","column","data","setting"]),oe,r("div",null,[r("div",ie,[ne,r("div",null,": "+f(n.value.selected),1)]),r("div",le,[se,r("div",null,": "+f(n.value.sortBy),1)]),r("div",de,[ue,r("div",null,": "+f(n.value.sortType),1)]),r("div",ce,[pe,r("div",null,": "+f(n.value.search),1)])])],512),[[B,!o(x)]]),V(r("div",null,[r("h1",me,f(o(w)!=null?`Update Data ${o(w).name}`:"Tambah Data"),1),l(o(s.TwForm),{name:U,class:Y(["grid grid-cols-12 gap-2 bg-white dark:bg-gray-900 dark:border dark:border-gray-700 rounded-lg p-2 shadow",{"tw-shake":h.value}]),rules:Q,onSubmit:e[12]||(e[12]=a=>o(w)!=null?F():M()),"custom-field-name":{inputName:"Input",textAreaExample:"Text Area",inputStock:"Input",inputPrice:"Input"}},{default:v(()=>[r("div",ve,[l(o(s.TwInput),{label:"Name",name:"inputName",modelValue:o(i).inputName,"onUpdate:modelValue":e[6]||(e[6]=a=>o(i).inputName=a),placeholder:"Input Name",type:"text"},null,8,["modelValue"]),l(d,{name:"inputName"})]),r("div",fe,[l(o(s.TwTextarea),{label:"Description",name:"textAreaDescription",modelValue:o(i).textAreaDescription,"onUpdate:modelValue":e[7]||(e[7]=a=>o(i).textAreaDescription=a),placeholder:"Description",type:"text"},null,8,["modelValue"]),l(d,{name:"textAreaDescription"})]),r("div",ye,[l(o(s.TwInput),{label:"Stock",name:"inputStock",modelValue:o(i).inputStock,"onUpdate:modelValue":e[8]||(e[8]=a=>o(i).inputStock=a),placeholder:"Input Stock",type:"number"},null,8,["modelValue"]),l(d,{name:"inputStock"})]),r("div",ge,[l(o(s.TwInput),{label:"Price",name:"inputPrice",modelValue:o(i).inputPrice,"onUpdate:modelValue":e[9]||(e[9]=a=>o(i).inputPrice=a),placeholder:"Input Price",type:"text"},null,8,["modelValue"]),l(d,{name:"inputPrice"})]),r("div",be,[l(o(s.TwButton),{variant:"primary",type:"button",class:"border border-gray-900",onClick:e[10]||(e[10]=a=>{C(),D(),E(void 0)})},{default:v(()=>[p(" Close ")]),_:1}),l(o(s.TwButton),{ripple:"",variant:"secondary",type:"button",class:"dark:text-gray-200 dark:!border-gray-800 dark:border",onClick:e[11]||(e[11]=a=>C())},{default:v(()=>[p(" Reset ")]),_:1}),l(o(s.TwButton),{variant:"primary"},{default:v(()=>[p(" Submit ")]),_:1})])]),_:1},8,["class"])],512),[[B,o(x)]])])}}});export{xe as default};
