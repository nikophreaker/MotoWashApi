import{_ as j}from"./ErrorMessage.vue.1a46e9a0.js";import{f as G,r as V,D as Z,v as s,i as I,s as z,o as y,c as f,M as A,N as $,u as n,a as o,b as r,w as c,d,F as D,t as u,m as g,n as J}from"./entry.b4992638.js";import{L as B}from"./main.29d865a7.js";const K=o("h2",{class:"text-2xl font-bold"},"Datatable Discount",-1),Q=o("hr",{class:"my-2 border dark:border-gray-700"},null,-1),W={class:"col-span-12 flex justify-start gap-1"},X={key:6,class:"flex gap-2 justify-center"},Y=o("div",{class:"p-2 rounded"},"Sorry, No Data Available",-1),ee=o("hr",{class:"my-2 dark:border-gray-700"},null,-1),te={class:"flex gap-2"},ae=o("div",{class:"w-32"},"Selected Data",-1),le={class:"flex gap-2"},ne=o("div",{class:"w-32"},"Order By",-1),oe={class:"flex gap-2"},ie=o("div",{class:"w-32"},"Order Type",-1),re={class:"flex gap-2"},se=o("div",{class:"w-32"},"Search",-1),de={class:"font-bold"},ue={class:"col-span-12"},pe={class:"col-span-12"},ce={class:"col-span-12"},me={class:"col-span-12"},ve={class:"col-span-12"},ye={class:"col-span-12"},fe={class:"col-span-12 flex justify-end gap-1"},N="formDiscount",we=G({__name:"discount",setup(ge){const i=V({column:[{label:"Code",field:"code",width:"400px",sortable:!0},{label:"Description",field:"description",width:"400px",sortable:!0},{label:"Type",field:"type",width:"400px",sortable:!0},{label:"Value",field:"value",width:"400px",sortable:!0},{label:"Start",field:"start_date",width:"400px",sortable:!0},{label:"End",field:"end_date",width:"400px",sortable:!0},{label:"Action",field:"action",width:"400px",sortable:!1}],data:[],limit:5,offset:0,search:"",selected:[],sortBy:"name",sortType:"asc",setting:{checkbox:!0,limitOption:[{label:"5",value:5},{label:"10",value:10},{label:"50",value:50},{label:"100",value:100},{label:"200",value:200}]}});var T=V(!1),_=new URLSearchParams;_.append("limit",i.value.limit.toString()),_.append("skip",i.value.offset.toString()),_.append("query",i.value.search.toString());const U=e=>{e()};async function E(){await fetch("/api/discount",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:_,redirect:"follow"}).then(e=>{e!=null&&e.json().then(t=>{t.error==null&&(i.value.data=t.data)})}).catch(e=>{})}async function L(){if(p.value.clearErrors(),await p.value.validate(),p.value.fail()){b.error({message:p.value.getErrorMessage()}),h.value=!0,setTimeout(()=>{h.value=!1},1e3);return}var e=new URLSearchParams;e.append("code",a.inputCode),e.append("description",a.textAreaDescription),e.append("type",a.inputType),e.append("value",a.inputValue),e.append("startDate",new Date(a.inputStartDate).toISOString().replace("Z"," ").replace("T"," ").replace(".000","")),e.append("endDate",new Date(a.inputEndDate).toISOString().replace("Z"," ").replace("T"," ").replace(".000","")),$fetch("/api/discount/discount",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(t=>{t!=null&&x(t)}).catch(t=>{x(t)})}async function M(){if(p.value.clearErrors(),await p.value.validate(),p.value.fail()){b.error({message:p.value.getErrorMessage()}),h.value=!0,setTimeout(()=>{h.value=!1},1e3);return}var e=new URLSearchParams;e.append("id",w.value.id),e.append("code",a.inputCode),e.append("description",a.textAreaDescription),e.append("type",a.inputType),e.append("value",a.inputValue),e.append("startDate",new Date(a.inputStartDate).toISOString().replace("Z"," ").replace("T"," ").replace(".000","")),e.append("endDate",new Date(a.inputEndDate).toISOString().replace("Z"," ").replace("T"," ").replace(".000","")),$fetch("/api/discount/discount",{method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(t=>{t!=null&&x(t)}).catch(t=>{x(t)})}Z(async()=>E());const O=s.useForm(),P=s.useDialog(),b=s.useToast();async function F(e){if(e!=null){if(!await P.fire({title:`Delete ${e.name}`,description:`Are you sure to delete ${e.name} ?`,icon:"alert-triangle"}))return;deleteProduct(e.id).then(m=>{m?b.success({message:`Success Delete ${e.name}`}):b.error({message:`Failed Delete ${e.name}`})})}}const h=V(!1),q=I(()=>O.getForm(N)),p=I(()=>q.value.validator);async function x(e){e.error!=null?b.error({message:e.message}):(k(void 0),S(),E(),C())}const a=z({inputCode:null,inputType:null,inputValue:null,textAreaDescription:null,inputStartDate:null,inputEndDate:null}),H={inputCode:["required","string"],inputValue:["required","numeric"],inputType:["required","string"],textAreaDescription:["required","string",e=>{if(!e||e.length<15)return`Min length is 15, current length is ${e.length}`}]};function C(){a.inputCode=null,a.inputType=null,a.inputValue=null,a.textAreaDescription=null,a.inputStartDate=null,a.inputEndDate=null,p.value.clearErrors()}var w=V();function k(e){w.value=e,e!=null&&(a.inputCode=e.code,a.inputType=e.type,a.inputValue=Number(e.value),a.textAreaDescription=e.description,a.inputStartDate=e.start_date,a.inputEndDate=e.end_date)}function S(){p.value.clearErrors(),T.value=!T.value}return(e,t)=>{const m=j;return y(),f("div",null,[K,Q,A(o("div",null,[o("div",W,[r(n(s.TwButton),{variant:"primary",icon:"plus-square",class:"border border-gray-900 my-2",onClick:t[0]||(t[0]=l=>S())},{default:c(()=>[d(" Add Data ")]),_:1})]),r(n(s.TwDatatableClient),{class:"!dark:text-gray-200",search:i.value.search,"onUpdate:search":t[1]||(t[1]=l=>i.value.search=l),limit:i.value.limit,"onUpdate:limit":t[2]||(t[2]=l=>i.value.limit=l),selected:i.value.selected,"onUpdate:selected":t[3]||(t[3]=l=>i.value.selected=l),"sort-by":i.value.sortBy,"onUpdate:sortBy":t[4]||(t[4]=l=>i.value.sortBy=l),"sort-type":i.value.sortType,"onUpdate:sortType":t[5]||(t[5]=l=>i.value.sortType=l),column:i.value.column,data:i.value.data,setting:i.value.setting,"onDatatable:columnHook":U},{row:c(({column:l,data:v})=>[l.field==="code"?(y(),f(D,{key:0},[d(u(v.code),1)],64)):g("",!0),l.field==="description"?(y(),f(D,{key:1},[d(u(v.description),1)],64)):g("",!0),l.field==="type"?(y(),f(D,{key:2},[d(u(v.type),1)],64)):g("",!0),l.field==="value"?(y(),f(D,{key:3},[d(u(Number(v.value)),1)],64)):g("",!0),l.field==="start_date"?(y(),f(D,{key:4},[d(u(new Date(v.start_date).toLocaleDateString("id-ID",{hour12:!1,weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})),1)],64)):g("",!0),l.field==="end_date"?(y(),f(D,{key:5},[d(u(new Date(v.end_date).toLocaleDateString("id-ID",{hour12:!1,weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})),1)],64)):g("",!0),l.field==="action"?(y(),f("div",X,[r(n(s.TwButton),{variant:"primary",class:"border border-gray-900",onClick:R=>{S(),k(v)}},{default:c(()=>[d(" Edit ")]),_:2},1032,["onClick"]),r(n(s.TwButton),{variant:"danger",onClick:R=>F(v)},{default:c(()=>[d(" Delete ")]),_:2},1032,["onClick"])])):g("",!0)]),empty:c(()=>[Y]),_:1},8,["search","limit","selected","sort-by","sort-type","column","data","setting"]),ee,o("div",null,[o("div",te,[ae,o("div",null,": "+u(i.value.selected),1)]),o("div",le,[ne,o("div",null,": "+u(i.value.sortBy),1)]),o("div",oe,[ie,o("div",null,": "+u(i.value.sortType),1)]),o("div",re,[se,o("div",null,": "+u(i.value.search),1)])])],512),[[$,!n(T)]]),A(o("div",null,[o("h1",de,u(n(w)!=null?`Update Data ${n(w).name}`:"Tambah Data"),1),r(n(s.TwForm),{name:N,class:J(["grid grid-cols-12 gap-2 bg-white dark:bg-gray-900 dark:border dark:border-gray-700 rounded-lg p-2 shadow",{"tw-shake":h.value}]),rules:H,onSubmit:t[14]||(t[14]=l=>n(w)!=null?M():L()),"custom-field-name":{inputCode:"Input",textAreaDescription:"Text Area",inputType:"Input",inputValue:"Input"}},{default:c(()=>[o("div",ue,[r(n(s.TwInput),{label:"Code",name:"inputCode",modelValue:n(a).inputCode,"onUpdate:modelValue":t[6]||(t[6]=l=>n(a).inputCode=l),placeholder:"Input Code",type:"text"},null,8,["modelValue"]),r(m,{name:"inputCode"})]),o("div",pe,[r(n(s.TwTextarea),{label:"Description",name:"textAreaDescription",modelValue:n(a).textAreaDescription,"onUpdate:modelValue":t[7]||(t[7]=l=>n(a).textAreaDescription=l),placeholder:"Description",type:"text"},null,8,["modelValue"]),r(m,{name:"textAreaDescription"})]),o("div",ce,[r(n(s.TwInput),{label:"Type",name:"inputType",modelValue:n(a).inputType,"onUpdate:modelValue":t[8]||(t[8]=l=>n(a).inputType=l),placeholder:"Input Type",type:"text"},null,8,["modelValue"]),r(m,{name:"inputType"})]),o("div",me,[r(n(s.TwInput),{label:"Value",name:"inputValue",modelValue:n(a).inputValue,"onUpdate:modelValue":t[9]||(t[9]=l=>n(a).inputValue=l),placeholder:"Input Value",type:"number"},null,8,["modelValue"]),r(m,{name:"inputValue"})]),o("div",ve,[r(n(B),{class:"dp",label:"Start Date",name:"inputStartDate",modelValue:n(a).inputStartDate,"onUpdate:modelValue":t[10]||(t[10]=l=>n(a).inputStartDate=l),placeholder:"Start Date",type:"text"},null,8,["modelValue"]),r(m,{name:"inputStartDate"})]),o("div",ye,[r(n(B),{class:"dp",label:"End Date",name:"inputEndDate",modelValue:n(a).inputEndDate,"onUpdate:modelValue":t[11]||(t[11]=l=>n(a).inputEndDate=l),placeholder:"End Date",type:"text"},null,8,["modelValue"]),r(m,{name:"inputEndDate"})]),o("div",fe,[r(n(s.TwButton),{variant:"primary",type:"button",class:"border border-gray-900",onClick:t[12]||(t[12]=l=>{C(),S(),k(void 0)})},{default:c(()=>[d(" Close ")]),_:1}),r(n(s.TwButton),{ripple:"",variant:"secondary",type:"button",class:"dark:text-gray-200 dark:!border-gray-800 dark:border",onClick:t[13]||(t[13]=l=>C())},{default:c(()=>[d(" Reset ")]),_:1}),r(n(s.TwButton),{variant:"primary"},{default:c(()=>[d(" Submit ")]),_:1})])]),_:1},8,["class"])],512),[[$,n(T)]])])}}});export{we as default};
