import{_ as H}from"./ErrorMessage.vue.8c25033d.js";import{f as z,r as C,D as G,v as s,i as S,s as J,o as f,c as y,M as V,N as B,u as l,a as o,b as r,w as m,d as u,F as P,t as p,m as h,n as K}from"./entry.9bb287b3.js";const Q=o("h2",{class:"text-2xl font-bold"},"Datatable Customer",-1),W=o("hr",{class:"my-2 border dark:border-gray-700"},null,-1),X={class:"col-span-12 flex justify-start gap-1"},Y={key:5,class:"flex gap-2 justify-center"},Z=o("div",{class:"p-2 rounded"},"Sorry, No Data Available",-1),ee=o("hr",{class:"my-2 dark:border-gray-700"},null,-1),te={class:"flex gap-2"},ae=o("div",{class:"w-32"},"Selected Data",-1),oe={class:"flex gap-2"},le=o("div",{class:"w-32"},"Order By",-1),ne={class:"flex gap-2"},ie=o("div",{class:"w-32"},"Order Type",-1),re={class:"flex gap-2"},se=o("div",{class:"w-32"},"Search",-1),ue={class:"font-bold"},de={class:"col-span-12"},pe={class:"col-span-12"},me={class:"col-span-12"},ce={class:"col-span-12"},ve={class:"col-span-12 flex justify-end gap-1"},$="formCustomer",ge=z({__name:"costumer",setup(fe){const i=C({column:[{label:"Name",field:"name",width:"400px",sortable:!0},{label:"Email",field:"email",width:"400px",sortable:!0},{label:"Phone",field:"phone",width:"400px",sortable:!0},{label:"JoinDate",field:"created_at",width:"400px",sortable:!0},{label:"Points",field:"loyalty_points",width:"400px",sortable:!0},{label:"Action",field:"action",width:"400px",sortable:!1}],data:[],limit:5,offset:0,search:"",selected:[],sortBy:"name",sortType:"asc",setting:{checkbox:!0,limitOption:[{label:"5",value:5},{label:"10",value:10},{label:"50",value:50},{label:"100",value:100},{label:"200",value:200}]}});var _=C(!1),T=new URLSearchParams;T.append("limit",i.value.limit.toString()),T.append("skip",i.value.offset.toString()),T.append("query",i.value.search.toString());const U=t=>{t()};async function E(){await fetch("/api/customer",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:T,redirect:"follow"}).then(t=>{t!=null&&t.json().then(e=>{e.error==null&&(i.value.data=e.data)})}).catch(t=>{})}async function I(){if(d.value.clearErrors(),await d.value.validate(),d.value.fail()){g.error({message:d.value.getErrorMessage()}),b.value=!0,setTimeout(()=>{b.value=!1},1e3);return}var t=new URLSearchParams;t.append("name",n.inputName),t.append("email",n.inputEmail),t.append("phone",n.inputPhone),t.append("loyaltyPoints",n.inputPoint),$fetch("/api/customer/customer",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,redirect:"follow"}).then(e=>{e!=null&&k(e)}).catch(e=>{k(e)})}async function F(){if(d.value.clearErrors(),await d.value.validate(),d.value.fail()){g.error({message:d.value.getErrorMessage()}),b.value=!0,setTimeout(()=>{b.value=!1},1e3);return}var t=new URLSearchParams;t.append("id",w.value.id),t.append("name",n.inputName),t.append("email",n.inputEmail),t.append("phone",n.inputPhone),t.append("loyaltyPoints",n.inputPoint),$fetch("/api/customer/customer",{method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,redirect:"follow"}).then(e=>{e!=null&&k(e)}).catch(e=>{k(e)})}function L(t){var e=new URLSearchParams;return e.append("id",t),$fetch("/api/customer/customer",{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(a=>a!=null?(E(),!0):!1).catch(a=>!1)}G(async()=>E());const R=s.useForm(),q=s.useDialog(),g=s.useToast();async function A(t){if(t!=null){if(!await q.fire({title:`Delete ${t.name}`,description:`Are you sure to delete ${t.name} ?`,icon:"alert-triangle"}))return;L(t.id).then(c=>{c?g.success({message:`Success Delete ${t.name}`}):g.error({message:`Failed Delete ${t.name}`})})}}const b=C(!1),M=S(()=>R.getForm($)),d=S(()=>M.value.validator);async function k(t){t.error!=null?g.error({message:t.message}):(N(void 0),x(),E(),D())}const n=J({inputName:null,inputEmail:null,inputPhone:null,inputPoint:null}),O={inputName:["required","string"],inputEmail:["required","string","email"],inputPhone:["required","string"],inputPoint:["required"]};function D(){n.inputName=null,n.inputEmail=null,n.inputPhone=null,n.inputPoint=null,d.value.clearErrors()}var w=C();function N(t){w.value=t,t!=null&&(n.inputName=t.name,n.inputEmail=t.email,n.inputPhone=t.phone,n.inputPoint=t.loyalty_points)}function x(){d.value.clearErrors(),_.value=!_.value}return(t,e)=>{const c=H;return f(),y("div",null,[Q,W,V(o("div",null,[o("div",X,[r(l(s.TwButton),{variant:"primary",icon:"user-plus",class:"border border-gray-900 my-2",onClick:e[0]||(e[0]=a=>x())},{default:m(()=>[u(" Add Data ")]),_:1})]),r(l(s.TwDatatableClient),{class:"!dark:text-gray-200",search:i.value.search,"onUpdate:search":e[1]||(e[1]=a=>i.value.search=a),limit:i.value.limit,"onUpdate:limit":e[2]||(e[2]=a=>i.value.limit=a),selected:i.value.selected,"onUpdate:selected":e[3]||(e[3]=a=>i.value.selected=a),"sort-by":i.value.sortBy,"onUpdate:sortBy":e[4]||(e[4]=a=>i.value.sortBy=a),"sort-type":i.value.sortType,"onUpdate:sortType":e[5]||(e[5]=a=>i.value.sortType=a),column:i.value.column,data:i.value.data,setting:i.value.setting,"onDatatable:columnHook":U},{row:m(({column:a,data:v})=>[a.field==="name"?(f(),y(P,{key:0},[u(p(v.name),1)],64)):h("",!0),a.field==="email"?(f(),y(P,{key:1},[u(p(v.email),1)],64)):h("",!0),a.field==="phone"?(f(),y(P,{key:2},[u(p(v.phone),1)],64)):h("",!0),a.field==="created_at"?(f(),y(P,{key:3},[u(p(new Date(v.created_at).toLocaleDateString("id-ID",{hour12:!1,weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})),1)],64)):h("",!0),a.field==="loyaltyPoints"?(f(),y(P,{key:4},[u(p(v.loyaltyPoints),1)],64)):h("",!0),a.field==="action"?(f(),y("div",Y,[r(l(s.TwButton),{variant:"primary",class:"border border-gray-900",onClick:j=>{x(),N(v)}},{default:m(()=>[u(" Edit ")]),_:2},1032,["onClick"]),r(l(s.TwButton),{variant:"danger",onClick:j=>A(v)},{default:m(()=>[u(" Delete ")]),_:2},1032,["onClick"])])):h("",!0)]),empty:m(()=>[Z]),_:1},8,["search","limit","selected","sort-by","sort-type","column","data","setting"]),ee,o("div",null,[o("div",te,[ae,o("div",null,": "+p(i.value.selected),1)]),o("div",oe,[le,o("div",null,": "+p(i.value.sortBy),1)]),o("div",ne,[ie,o("div",null,": "+p(i.value.sortType),1)]),o("div",re,[se,o("div",null,": "+p(i.value.search),1)])])],512),[[B,!l(_)]]),V(o("div",null,[o("h1",ue,p(l(w)!=null?`Update Data ${l(w).name}`:"Tambah Data"),1),r(l(s.TwForm),{name:$,class:K(["grid grid-cols-12 gap-2 bg-white dark:bg-gray-900 dark:border dark:border-gray-700 rounded-lg p-2 shadow",{"tw-shake":b.value}]),rules:O,onSubmit:e[12]||(e[12]=a=>l(w)!=null?F():I()),"custom-field-name":{inputName:"Input",inputEmail:"Input",inputPhone:"Input",inputPoint:"Input"}},{default:m(()=>[o("div",de,[r(l(s.TwInput),{label:"Name",name:"inputName",modelValue:l(n).inputName,"onUpdate:modelValue":e[6]||(e[6]=a=>l(n).inputName=a),placeholder:"Input Name",type:"text"},null,8,["modelValue"]),r(c,{name:"inputName"})]),o("div",pe,[r(l(s.TwInput),{label:"Email",name:"inputEmail",modelValue:l(n).inputEmail,"onUpdate:modelValue":e[7]||(e[7]=a=>l(n).inputEmail=a),placeholder:"Input Email",type:"text"},null,8,["modelValue"]),r(c,{name:"inputEmail"})]),o("div",me,[r(l(s.TwInput),{label:"Phone",name:"inputPhone",modelValue:l(n).inputPhone,"onUpdate:modelValue":e[8]||(e[8]=a=>l(n).inputPhone=a),placeholder:"Input Phone",type:"text"},null,8,["modelValue"]),r(c,{name:"inputPhone"})]),o("div",ce,[r(l(s.TwInput),{label:"Loyalty Point",name:"inputPoint",modelValue:l(n).inputPoint,"onUpdate:modelValue":e[9]||(e[9]=a=>l(n).inputPoint=a),placeholder:"Input Point",type:"number"},null,8,["modelValue"]),r(c,{name:"inputPoint"})]),o("div",ve,[r(l(s.TwButton),{variant:"primary",type:"button",class:"border border-gray-900",onClick:e[10]||(e[10]=a=>{D(),x(),N(void 0)})},{default:m(()=>[u(" Close ")]),_:1}),r(l(s.TwButton),{ripple:"",variant:"secondary",type:"button",class:"dark:text-gray-200 dark:!border-gray-800 dark:border",onClick:e[11]||(e[11]=a=>D())},{default:m(()=>[u(" Reset ")]),_:1}),r(l(s.TwButton),{variant:"primary"},{default:m(()=>[u(" Submit ")]),_:1})])]),_:1},8,["class"])],512),[[B,l(_)]])])}}});export{ge as default};
