import{_ as W}from"./ErrorMessage.vue.1a46e9a0.js";import{f as X,r as k,D as Y,v as r,i as V,s as Z,o as m,c as v,M as B,N as $,u as l,a as n,b as s,w as f,d,F as g,t as h,m as b,k as K,n as ee}from"./entry.b4992638.js";const te=n("h2",{class:"text-2xl font-bold"},"Datatable Customer",-1),ae=n("hr",{class:"my-2 border dark:border-gray-700"},null,-1),le={class:"col-span-12 flex justify-start gap-1"},ne={key:5,class:"flex gap-2 justify-center"},oe=n("div",{class:"p-2 rounded"},"Sorry, No Data Available",-1),ie=n("hr",{class:"my-2 dark:border-gray-700"},null,-1),se={class:"flex gap-2"},re=n("div",{class:"w-32"},"Selected Data",-1),ue={class:"flex gap-2"},de=n("div",{class:"w-32"},"Order By",-1),pe={class:"flex gap-2"},ce=n("div",{class:"w-32"},"Order Type",-1),me={class:"flex gap-2"},ve=n("div",{class:"w-32"},"Search",-1),fe={class:"font-bold"},ye={class:"col-span-12"},he={class:"col-span-12"},ge={class:"col-span-12"},be={class:"col-span-12"},we={class:"input wrapper flex items-center"},Pe={key:0},_e={key:1,class:"input wrapper flex items-center"},ke={class:"col-span-12"},Te={class:"col-span-12 flex justify-end gap-1"},U="formCustomer",De=X({__name:"costumer",setup(Ce){const i=k({column:[{label:"Name",field:"name",width:"400px",sortable:!0},{label:"Email",field:"email",width:"400px",sortable:!0},{label:"Phone",field:"phone",width:"400px",sortable:!0},{label:"License",field:"licensePlates",width:"400px",sortable:!0},{label:"Points",field:"loyaltyPoints",width:"400px",sortable:!0},{label:"Action",field:"action",width:"400px",sortable:!1}],data:[],limit:5,offset:0,search:"",selected:[],sortBy:"name",sortType:"asc",setting:{checkbox:!0,limitOption:[{label:"5",value:5},{label:"10",value:10},{label:"50",value:50},{label:"100",value:100},{label:"200",value:200}]}});var T=k(!1),C=new URLSearchParams;C.append("limit",i.value.limit.toString()),C.append("skip",i.value.offset.toString()),C.append("query",i.value.search.toString());const I=t=>{t()};function F(t,e,u){t[u]=t[e],delete t[e]}function A(t,e,u){t[u]=t[e].toString(),delete t[e]}async function L(){await fetch("/api/customer",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:C,redirect:"follow"}).then(t=>{t!=null&&t.json().then(e=>{if(e.error==null){const u=e;u.forEach(a=>F(a,"_id","id")),u.forEach(a=>A(a,"licensePlates","_licensePlates")),i.value.data=u,i.value.setting.limitOption}})}).catch(t=>{})}async function R(){if(y.value.clearErrors(),await y.value.validate(),y.value.fail()){w.error({message:y.value.getErrorMessage()}),P.value=!0,setTimeout(()=>{P.value=!1},1e3);return}var t=new URLSearchParams;t.append("name",o.inputName),t.append("email",o.inputEmail),t.append("phone",o.inputPhone),t.append("licensePlates",p.value.toString()),t.append("loyaltyPoints",o.inputPoint),$fetch("/api/customer/customer",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,redirect:"follow"}).then(e=>{e!=null&&E(e)}).catch(e=>{E(e)})}async function q(){if(y.value.clearErrors(),await y.value.validate(),y.value.fail()){w.error({message:y.value.getErrorMessage()}),P.value=!0,setTimeout(()=>{P.value=!1},1e3);return}var t=new URLSearchParams;t.append("id",_.value.id),t.append("name",o.inputName),t.append("email",o.inputEmail),t.append("phone",o.inputPhone),t.append("licensePlates",p.value.toString()),t.append("loyaltyPoints",o.inputPoint),$fetch("/api/customer/customer",{method:"PATCH",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,redirect:"follow"}).then(e=>{e!=null&&E(e)}).catch(e=>{E(e)})}function O(t){var e=new URLSearchParams;return e.append("id",t),$fetch("/api/customer/customer",{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e,redirect:"follow"}).then(a=>a!=null?(L(),!0):!1).catch(a=>!1)}Y(async()=>L());const M=r.useForm(),H=r.useDialog(),w=r.useToast();async function z(t){if(t!=null){if(!await H.fire({title:`Delete ${t.name}`,description:`Are you sure to delete ${t.name} ?`,icon:"alert-triangle"}))return;O(t.id).then(u=>{u?w.success({message:`Success Delete ${t.name}`}):w.error({message:`Failed Delete ${t.name}`})})}}const P=k(!1),G=V(()=>M.getForm(U)),y=V(()=>G.value.validator);async function E(t){t.error!=null?w.error({message:t.message}):(S(void 0),x(),L(),N())}const o=Z({inputName:null,inputEmail:null,inputPhone:null,inputLicense:[],inputPoint:null}),j={inputName:["required","string"],inputEmail:["required","string","email"],inputPhone:["required","string"],inputLicense:["required","string"],inputPoint:["required"]};function N(){o.inputName=null,o.inputEmail=null,o.inputPhone=null,o.inputLicense=[],o.inputPoint=null,p.value=[],y.value.clearErrors()}var _=k(),p=k([""]);function S(t){_.value=t,t!=null?(o.inputName=t.name,o.inputEmail=t.email,o.inputPhone=t.phone,o.inputLicense=t._licensePlates.split(","),o.inputPoint=t.loyaltyPoints,p.value.pop(),o.inputLicense.forEach(e=>p.value.push(e))):p.value.push("")}function x(){y.value.clearErrors(),T.value=!T.value}function J(){p.value.push("")}async function Q(t){p.value.splice(t,1)}return(t,e)=>{const u=W;return m(),v("div",null,[te,ae,B(n("div",null,[n("div",le,[s(l(r.TwButton),{variant:"primary",icon:"user-plus",class:"border border-gray-900 my-2",onClick:e[0]||(e[0]=a=>x())},{default:f(()=>[d(" Add Data ")]),_:1})]),s(l(r.TwDatatableClient),{class:"!dark:text-gray-200",search:i.value.search,"onUpdate:search":e[1]||(e[1]=a=>i.value.search=a),limit:i.value.limit,"onUpdate:limit":e[2]||(e[2]=a=>i.value.limit=a),selected:i.value.selected,"onUpdate:selected":e[3]||(e[3]=a=>i.value.selected=a),"sort-by":i.value.sortBy,"onUpdate:sortBy":e[4]||(e[4]=a=>i.value.sortBy=a),"sort-type":i.value.sortType,"onUpdate:sortType":e[5]||(e[5]=a=>i.value.sortType=a),column:i.value.column,data:i.value.data,setting:i.value.setting,"onDatatable:columnHook":I},{row:f(({column:a,data:c})=>[a.field==="name"?(m(),v(g,{key:0},[d(h(c.name),1)],64)):b("",!0),a.field==="email"?(m(),v(g,{key:1},[d(h(c.email),1)],64)):b("",!0),a.field==="phone"?(m(),v(g,{key:2},[d(h(c.phone),1)],64)):b("",!0),a.field==="licensePlates"?(m(),v(g,{key:3},[d(h(c._licensePlates),1)],64)):b("",!0),a.field==="loyaltyPoints"?(m(),v(g,{key:4},[d(h(c.loyaltyPoints),1)],64)):b("",!0),a.field==="action"?(m(),v("div",ne,[s(l(r.TwButton),{variant:"primary",class:"border border-gray-900",onClick:D=>{x(),S(c)}},{default:f(()=>[d(" Edit ")]),_:2},1032,["onClick"]),s(l(r.TwButton),{variant:"danger",onClick:D=>z(c)},{default:f(()=>[d(" Delete ")]),_:2},1032,["onClick"])])):b("",!0)]),empty:f(()=>[oe]),_:1},8,["search","limit","selected","sort-by","sort-type","column","data","setting"]),ie,n("div",null,[n("div",se,[re,n("div",null,": "+h(i.value.selected),1)]),n("div",ue,[de,n("div",null,": "+h(i.value.sortBy),1)]),n("div",pe,[ce,n("div",null,": "+h(i.value.sortType),1)]),n("div",me,[ve,n("div",null,": "+h(i.value.search),1)])])],512),[[$,!l(T)]]),B(n("div",null,[n("h1",fe,h(l(_)!=null?`Update Data ${l(_).name}`:"Tambah Data"),1),s(l(r.TwForm),{name:U,class:ee(["grid grid-cols-12 gap-2 bg-white dark:bg-gray-900 dark:border dark:border-gray-700 rounded-lg p-2 shadow",{"tw-shake":P.value}]),rules:j,onSubmit:e[13]||(e[13]=a=>l(_)!=null?q():R()),"custom-field-name":{inputName:"Input",inputEmail:"Input",inputPhone:"Input",inputPoint:"Input"}},{default:f(()=>[n("div",ye,[s(l(r.TwInput),{label:"Name",name:"inputName",modelValue:l(o).inputName,"onUpdate:modelValue":e[6]||(e[6]=a=>l(o).inputName=a),placeholder:"Input Name",type:"text"},null,8,["modelValue"]),s(u,{name:"inputName"})]),n("div",he,[s(l(r.TwInput),{label:"Email",name:"inputEmail",modelValue:l(o).inputEmail,"onUpdate:modelValue":e[7]||(e[7]=a=>l(o).inputEmail=a),placeholder:"Input Email",type:"text"},null,8,["modelValue"]),s(u,{name:"inputEmail"})]),n("div",ge,[s(l(r.TwInput),{label:"Phone",name:"inputPhone",modelValue:l(o).inputPhone,"onUpdate:modelValue":e[8]||(e[8]=a=>l(o).inputPhone=a),placeholder:"Input Phone",type:"text"},null,8,["modelValue"]),s(u,{name:"inputPhone"})]),n("div",be,[(m(!0),v(g,null,K(l(p).length,(a,c)=>(m(),v("div",we,[n("div",null,[s(l(r.TwInput),{label:c<=0?"License Plates":"",name:"inputLicense",modelValue:l(p)[c],"onUpdate:modelValue":D=>l(p)[c]=D,placeholder:"Input License",type:"text"},null,8,["label","modelValue","onUpdate:modelValue"]),s(u,{name:"inputLicense"})]),l(p).length<=1?(m(),v("div",Pe)):(m(),v("div",_e,[s(l(r.TwButton),{variant:"danger",type:"button",onClick:D=>Q(c),class:"border border-gray-900 bg-red-800"},{default:f(()=>[d(" Delete ")]),_:2},1032,["onClick"])]))]))),256)),s(l(r.TwButton),{variant:"primary",type:"button",class:"border border-gray-900 bg-gray-800 my-3",onClick:e[9]||(e[9]=a=>J())},{default:f(()=>[d(" Add License Plate ")]),_:1})]),n("div",ke,[s(l(r.TwInput),{label:"Loyalty Point",name:"inputPoint",modelValue:l(o).inputPoint,"onUpdate:modelValue":e[10]||(e[10]=a=>l(o).inputPoint=a),placeholder:"Input Point",type:"number"},null,8,["modelValue"]),s(u,{name:"inputPoint"})]),n("div",Te,[s(l(r.TwButton),{variant:"primary",type:"button",class:"border border-gray-900",onClick:e[11]||(e[11]=a=>{N(),x(),S(void 0)})},{default:f(()=>[d(" Close ")]),_:1}),s(l(r.TwButton),{ripple:"",variant:"secondary",type:"button",class:"dark:text-gray-200 dark:!border-gray-800 dark:border",onClick:e[12]||(e[12]=a=>N())},{default:f(()=>[d(" Reset ")]),_:1}),s(l(r.TwButton),{variant:"primary"},{default:f(()=>[d(" Submit ")]),_:1})])]),_:1},8,["class"])],512),[[$,l(T)]])])}}});export{De as default};
